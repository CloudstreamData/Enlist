<?xml version="1.0"?>

<mach-ii>
	<plugins>
		<plugin name="security" type="Enlist.controllers.plugins.SecurityPlugin">
			<parameters>
				<parameter name="authenticationRequiredEvent" value="doLoginRedirect"/>
				<parameter name="authenticationRequiredMessage" value="The requested page requires authentication."/>
				<parameter name="authorizationFailedEvent" value="showAccessDenied"/>
				<parameter name="authorizationFailedMessage" value="Access to the requested page is not authorized."/>
				<parameter name="securityRules">
					<array>
						<!-- Bypass security rules in development -->
						<element>
							<struct>
								<key name="environment" value="group:development"/>
								<key name="eventPattern" value=".*"/>
								<key name="action" value="allow"/>
							</struct>
						</element>

						<!-- Allowed events for any request -->
						<element>
							<struct>
								<key name="eventNames" value="home,logout,register"/>
								<key name="action" value="allow"/>
							</struct>
						</element>

						<!-- Restrict by role -->
						<element>
							<struct>
								<key name="eventPattern" value=".*"/>
								<key name="action" value="requireRole"/>
								<key name="roleRequired" value="admin"/>
							</struct>
						</element>
						
					</array>
				</parameter>
			</parameters>		
		</plugin>
	</plugins>
	
</mach-ii>	